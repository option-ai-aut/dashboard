<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="p-8">
    <h1 class="text-3xl font-bold mb-6">Clients</h1>
    
    <button id="reloadBtn" class="bg-blue-500 text-white px-4 py-2 rounded mb-4 hover:bg-blue-600">
        Neu laden
    </button>
    
    <table id="clientsTable" class="w-full border-collapse border border-gray-300">
        <thead>
            <tr class="bg-gray-100">
                <th class="border border-gray-300 px-4 py-2 text-left font-bold">Code</th>
                <th class="border border-gray-300 px-4 py-2 text-left font-bold">Name</th>
                <th class="border border-gray-300 px-4 py-2 text-left font-bold">Status</th>
                <th class="border border-gray-300 px-4 py-2 text-left font-bold">Öffnen</th>
            </tr>
        </thead>
        <tbody>
            <!-- Table rows will be inserted here -->
        </tbody>
    </table>

    <script>
        async function loadClients(){
            const res = await fetch('https://optionai.optionai.at/webhook/admin/load-clients');
            const list = await res.json();
            const body = document.querySelector('#clientsTable tbody');
            body.innerHTML = '';
            list.forEach(c=>{
                const tr = document.createElement('tr');
                tr.className = 'hover:bg-gray-50';
                tr.innerHTML = `
                    <td class="border border-gray-300 px-4 py-2">${c["Proposal Code"]}</td>
                    <td class="border border-gray-300 px-4 py-2">${c["Full Name"]}</td>
                    <td class="border border-gray-300 px-4 py-2">${c.Status}</td>
                    <td class="border border-gray-300 px-4 py-2"><a href="/admin/client.html?code=${c["Proposal Code"]}" class="text-blue-600 underline">öffnen</a></td>`;
                body.appendChild(tr);
            });
        }
        document.getElementById('reloadBtn').onclick = loadClients;
        loadClients();
    </script>
</body>
</html>